<div [class]="containerClasses()" role="radiogroup" [attr.aria-label]="ariaLabel">
  @for (star of starsArray(); track $index) {
    <button
      type="button"
      [class]="starClasses($index)"
      [disabled]="disabled || readonly"
      [attr.aria-checked]="$index < value()"
      (click)="onStarClick($index)"
      (mouseenter)="onStarHover($index)"
      (mouseleave)="onStarLeave()"
      (focus)="onFocus.emit($event)"
      (blur)="onInputBlur()"
    >
      @if ($index < getFilledStars($index)) {
        <!-- Filled star -->
        <svg [class]="iconClasses()" fill="currentColor" viewBox="0 0 24 24">
          <path
            d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
          />
        </svg>
      } @else if ($index < getFilledStars($index) + 0.5 && allowHalf) {
        <!-- Half star -->
        <svg [class]="iconClasses()" viewBox="0 0 24 24">
          <defs>
            <linearGradient [id]="'half-' + $index">
              <stop offset="50%" stop-color="currentColor" />
              <stop offset="50%" stop-color="transparent" />
            </linearGradient>
          </defs>
          <path
            [attr.fill]="'url(#half-' + $index + ')'"
            stroke="currentColor"
            stroke-width="1"
            d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
          />
        </svg>
      } @else {
        <!-- Empty star -->
        <svg
          [class]="iconClasses()"
          fill="none"
          stroke="currentColor"
          stroke-width="1.5"
          viewBox="0 0 24 24"
        >
          <path
            d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
          />
        </svg>
      }
    </button>
  }
  @if (showValue) {
    <span [class]="valueClasses()">{{ value() }}</span>
  }
  @if (showCancel && value() > 0 && !readonly) {
    <button
      type="button"
      class="ml-2 p-1 text-slate-400 hover:text-slate-600 transition-colors"
      (click)="clear()"
      aria-label="Clear rating"
    >
      <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  }
</div>
